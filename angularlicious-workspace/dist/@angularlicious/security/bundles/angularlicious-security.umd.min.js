!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/common"),require("@angularlicious/core"),require("@angular/router"),require("@angular/core"),require("@angularlicious/foundation"),require("@angularlicious/logging"),require("@angular/forms"),require("@angular/common/http"),require("@angularlicious/rules-engine"),require("@angularlicious/configuration")):"function"==typeof define&&define.amd?define("@angularlicious/security",["exports","@angular/common","@angularlicious/core","@angular/router","@angular/core","@angularlicious/foundation","@angularlicious/logging","@angular/forms","@angular/common/http","@angularlicious/rules-engine","@angularlicious/configuration"],r):r((e.angularlicious=e.angularlicious||{},e.angularlicious.security={}),e.ng.common,e.core,e.ng.router,e.ng.core,e.foundation,e.logging,e.ng.forms,e.ng.common.http,e.rules,e.configuration)}(this,function(e,i,t,r,s,o,u,n,c,a,l){"use strict";var g=function(e,r){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])})(e,r)};function p(e,r){function i(){this.constructor=e}g(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}var m=function(i){function e(e){var r=i.call(this)||this;return r.subscriber=e,r.actionName="RegisterSubscriberAction",r}return p(e,i),e.prototype.preValidateAction=function(){console.log("Running the [preValidateAction] for the "+this.actionName+" action."),this.validationContext.withSource(this.actionName).addRule(new a.StringIsNotNullEmptyRange("NameIsValid","The name value is not valid. Must be between 1-40 characters.",this.subscriber.Name,2,40,!0)).addRule(new a.StringIsNotNullEmptyRange("EmailIsValid","The email address value is not valid. Must be between 5-60 characters.",this.subscriber.EmailAddress,5,60,!0))},e.prototype.performAction=function(){this.loggingService.log(this.actionName,u.Severity.Information,"Running the [performAction] for the "+this.actionName+"."),this.response=this.businessProvider.securityApiService.registerSubscriber(this.subscriber)},e}(function(e){function r(){return e.call(this)||this}return p(r,e),r.prototype.Do=function(e){this.businessProvider=e,this.serviceContext=e.serviceContext,this.loggingService=e.loggingService,this.execute()},r}(o.ActionBase)),f=function(n){function e(e,r,i){var t=n.call(this,e,i)||this;return t.httpService=r,t}return p(e,n),e.prototype.registerSubscriber=function(e){var r="api/subscriber/register",i=this.serviceName+" preparing to call: "+r;this.loggingService.log(this.serviceName,u.Severity.Information,i);var t=JSON.stringify(e),n=this.httpService.createRequestOptions(o.HttpRequestMethod.post,this.httpService.createHeader(!1),r,t);return this.httpService.post(n)},e.decorators=[{type:s.Injectable}],e.ctorParameters=function(){return[{type:c.HttpClient},{type:o.HttpBaseService},{type:u.AngularliciousLoggingService}]},e}(o.HttpBaseService),b=function(t){function e(e,r){var i=t.call(this,e)||this;return i.securityApiService=r,i}return p(e,t),e.prototype.registerSubscriber=function(e){var r=new m(e);return r.Do(this),r.response},e.decorators=[{type:s.Injectable}],e.ctorParameters=function(){return[{type:u.AngularliciousLoggingService},{type:f}]},e}(o.ServiceBase),d=function y(e,r){this.SubscriptionStart=new Date,this.Name=e,this.EmailAddress=r},h=function(t){function e(e,r){var i=t.call(this,e)||this;return i.businessProvider=r,i.serviceName="AngularliciousSecurityService",i.businessProvider.serviceContext=i.serviceContext,i.businessProvider.loggingService=i.loggingService,i}return p(e,t),e.prototype.registerSubscriber=function(e){var r="Preparing to register subscriber: "+JSON.stringify(e);return this.loggingService.log(this.serviceName,u.Severity.Information,r),this.businessProvider.registerSubscriber(e)},e.prototype.verifyService=function(){if(this.loggingService&&this.businessProvider&&this.businessProvider.securityApiService)return!0},e.decorators=[{type:s.Injectable}],e.ctorParameters=function(){return[{type:u.AngularliciousLoggingService},{type:b}]},e}(o.ServiceBase),v=function(o){function e(e,r,i,t){var n=o.call(this,"RegisterSubscriberComponent",r,t)||this;return n.securityService=e,n.formBuilder=i,n.subscribe=new s.EventEmitter,n}return p(e,o),e.prototype.ngOnInit=function(){this.buildForm()},e.prototype.buildForm=function(){this._form=this.formBuilder.group({subscriberName:["",n.Validators.required],emailAddress:["",n.Validators.required]})},e.prototype.submitForm=function(){this.securityService.resetServiceContext(),this.subscriber=new d(this._form.value.subscriberName,this._form.value.emailAddress),this.subscribeUser(this.subscriber)},e.prototype.subscribeUser=function(e){var r=this;this.securityService.registerSubscriber(e).subscribe(function(e){return r.handleSubscribeUser(e)},function(e){return r.handleServiceErrors(e,r.securityService.serviceContext)},function(){return r.finishRequest(r.componentName)})},e.prototype.handleSubscribeUser=function(e){var r="[handleSubscribeUser]: Preparing to handle the response from the [SecurityService] in the "+this.componentName+".";if(this.loggingService.log(this.componentName,u.Severity.Information,r),e)if(e.IsSuccess){this.loggingService.log(this.componentName,u.Severity.Information,"Successfully processed request to create subscriber. Prepare to download..."),this.subscribe.emit(e)}else this.handleServiceErrors(null,this.securityService.serviceContext)},e.decorators=[{type:s.Component,args:[{selector:"bm-register-subscriber",template:'<angularlicious-alert [alertNotification]="alertNotification" [hasMessage]="alertNotification.showAlert"></angularlicious-alert>\r\n\x3c!-- SUBSCRIBE SIGN-UP FORM --\x3e\r\n<form [formGroup]="_form" (ngSubmit)="submitForm()">\r\n  \x3c!-- SUBSCRIBER NAME --\x3e\r\n  <div class="input-group form-group-no-border">\r\n    <span class="input-group-addon">\r\n      <i class="now-ui-icons users_circle-08"></i>\r\n    </span>\r\n    <input type="text" formControlName="subscriberName" class="form-control" placeholder="Name...">\r\n  </div>\r\n  \x3c!-- SUBSCRIBER EMAIL --\x3e\r\n  <div class="input-group form-group-no-border">\r\n    <span class="input-group-addon">\r\n      <i class="now-ui-icons ui-1_email-85"></i>\r\n    </span>\r\n    <input type="text" formControlName="emailAddress" class="form-control" placeholder="Email...">\r\n  </div>\r\n  \x3c!-- SUBSCRIBE BUTTON --\x3e\r\n  <button class="btn btn-neutral btn-round btn-lg">Subscribe\r\n    <i class="fa fa-check ml-1"></i>\r\n  </button>\r\n</form>\r\n\x3c!-- SUBSCRIBE SIGN-UP FORM --\x3e',styles:[""]}]}],e.ctorParameters=function(){return[{type:h},{type:u.AngularliciousLoggingService},{type:n.FormBuilder},{type:r.Router}]},e.propDecorators={subscribe:[{type:s.Output}]},e}(o.ComponentBase),S=function(){function r(){}return r.forRoot=function(e){return{ngModule:r,providers:[{provide:l.LoggingConfig,useValue:e},c.HttpClientModule]}},r.decorators=[{type:s.NgModule,args:[{imports:[u.AngularliciousLoggingModule,o.AngularliciousFoundationModule,t.AngularliciousCoreModule,a.AngularliciousRulesEngineModule,i.CommonModule,n.FormsModule,n.ReactiveFormsModule,c.HttpClientModule],declarations:[v],exports:[v],providers:[u.AngularliciousLoggingService,f,b]}]}],r}();e.AngularliciousSecurityModule=S,e.AngularliciousSecurityService=h,e.RegisterSubscriberComponent=v,e.Subscriber=d,e.ɵb=f,e.ɵa=b,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=angularlicious-security.umd.min.js.map